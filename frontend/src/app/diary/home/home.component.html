<div class="bg-[url('https://th.bing.com/th/id/OIP.78fEY4JZgs24LIP0pXZiiAHaDt?w=349&h=175&c=7&r=0&o=5&pid=1.7')] bg-cover bg-center min-h-screen flex items-center justify-center py-10 px-4">


<div class="container">
  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="loading-backdrop">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <span class="loading-text">Loading...</span>
    </div>
  </div>
  <div class="navbar">
    <h1>Secret Thought Journal</h1>
    <div class="navbar-actions">
      <button class="nav-btn" (click)="openReminderModal()">Set Reminder</button>

      <button class="nav-btn" (click)="logout()">Logout</button>
    </div>
    <div class="welcome-msg text-xl font-semibold text-gray-700 ml-4">Welcome, {{ userName }}</div>

  </div>
  <div class="hero">
    <!-- <h1>Your Private Diary</h1> -->
    <p>Keep track of your thoughts and emotions in a private, secure space.</p>
  </div>
  <div class="mood-filter-section">
    <div class="section-title">Filter by Mood</div>
    <div class="mood-buttons">
      <button
        *ngFor="let mood of moods"
        (click)="filterByMood(mood.name)"
        class="mood-btn"
        [class.active-mood]="selectedMood === mood.name"
      >
        {{ mood.emoji }} {{ mood.name }}
      </button>
    </div>
  </div>
  
  <div class="flex flex-col items-center gap-2 md:flex-row md:justify-start md:items-end mb-4">
    <label for="dateFilter" class="text-gray-700 font-medium">Filter by Date:</label>
    <input
      type="date"
      id="dateFilter"
      [(ngModel)]="selectedDate"
      (change)="onDateChange($event)"
      class="appearance-none w-full md:w-auto px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-gray-700 bg-white"
    />
  </div>
  
  <!-- Mood Filter Section -->
<!-- <div class="mood-filter-section">
  <div class="section-title">Filter by mood</div>
  <div class="mood-buttons">
    <button (click)="filterByMood('')" class="mood-btn">All</button>
    <button (click)="filterByMood('happy')" class="mood-btn">Happy</button>
    <button (click)="filterByMood('sad')" class="mood-btn">Sad</button>
    <button (click)="filterByMood('angry')" class="mood-btn">Angry</button>
    <button (click)="filterByMood('neutral')" class="mood-btn">Neutral</button>
    <button (click)="filterByMood('excited')" class="mood-btn">Excited</button>
    <button (click)="filterByMood('anxious')" class="mood-btn">Anxious</button>
    <button (click)="filterByMood('grateful')" class="mood-btn">Grateful</button>
  </div>
</div> -->


  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
    <button (click)="errorMessage = ''" class="error-close">&times;</button>
  </div>

  <!-- Hero Section -->
  
<!-- reminder-settings.component.html -->
<!-- Reminder Modal -->
<!-- Reminder Modal -->
<div *ngIf="showReminderModal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
    <h3 class="text-xl font-semibold mb-4">Reminder Settings</h3>

    <form (ngSubmit)="saveReminderPreference()">
      <label class="block mb-2 text-sm">
        <input type="checkbox" [(ngModel)]="reminderEnabled" name="reminderEnabled" class="mr-2"/>
        Enable Daily Reminder Email
      </label>

      <div *ngIf="reminderEnabled">
        <label class="block mb-1 text-sm">Reminder Time:</label>
        <input type="time" [(ngModel)]="reminderTime" name="reminderTime" class="border p-2 rounded w-full" />
      </div>

      <div class="flex justify-end gap-4 mt-4">
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition" (click)="closeReminderModal()">Save</button>
        <button type="button" class="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400 transition" (click)="closeReminderModal()">Cancel</button>
      </div>
    </form>
  </div>
</div>

  <!-- Create Entry Button -->
  <div style="text-align: center;">
    <button
      (click)="openModal()"
      class="create-btn"
    >
      Create New Entry
    </button>
  </div>

  <!-- Filter Section -->
  <!-- <div class="filter-container">
    <input
      [(ngModel)]="filter"
      type="text"
      placeholder="Search by mood..."
      class="filter-input"
    />
    <button
      (click)="applyFilter()"
      class="filter-btn"
    >
      Apply Filter
    </button>
  </div>
  <p *ngIf="filter" style="text-align: center; color: #64748b; font-size: 0.875rem; margin-bottom: 1.5rem;">
    Filtering by mood: {{ filter }}
  </p> -->
  
  <!-- Diary Entries -->
  <div *ngIf="entries.length; else noEntries" class="entries-grid">
    <div *ngFor="let entry of entries; let i = index" class="entry-card" [style.animation-delay]="i * 0.1 + 's'">
      <div class="card-content">
        <h2 class="card-title">{{ entry.title }}</h2>
        <div class="text-sm text-gray-500 italic mt-2">
          Posted {{ entry.createdAt | relativeTime }}
        </div>
        <p class="card-text">{{ entry.content | slice:0:100 }}{{ entry.content.length > 100 ? '...' : '' }}</p>
        
        <!-- Tags Display -->
        <div class="card-tags">
          <span *ngFor="let tag of getTags(entry)" class="tag">
            {{ tag }}
          </span>
        </div>
        
        <!-- Mood Display -->
        <div class="card-mood">
          <span [ngSwitch]="entry.mood">
            <span *ngSwitchCase="'happy'">Happy 😊</span>
<span *ngSwitchCase="'sad'">Sad 😔</span>
<span *ngSwitchCase="'angry'">Angry 😡</span>
<span *ngSwitchCase="'excited'">Excited 😃</span>
<span *ngSwitchCase="'neutral'">Neutral 😐</span>
<span *ngSwitchCase="'anxious'">Anxious 😰</span>
<span *ngSwitchCase="'grateful'">Grateful 🙏</span>
<span *ngSwitchCase="'lonely'">Lonely 😞</span>
<span *ngSwitchCase="'motivated'">Motivated 💪</span>
<span *ngSwitchCase="'tired'">Tired 😴</span>
<span *ngSwitchCase="'confused'">Confused 😕</span>
<span *ngSwitchDefault>{{ entry.mood || 'No mood set' }}</span>

          </span>
        </div>
        
        <div class="card-actions">
          <button
            (click)="openEditModal(entry)"
            class="btn btn-edit"
          >
            Edit
          </button>
          <button
            (click)="openViewModal(entry)"
            class="btn btn-view"
          >
            View
          </button>
          <button
            (click)="deleteEntry(entry._id)"
            class="btn btn-delete"
          >
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <ng-template #noEntries>
    <div class="empty-state">
      <p>No entries found. Create your first entry!</p>
    </div>
  </ng-template>
  
  <!-- View Entry Modal -->
  <div *ngIf="viewEntry" class="modal-backdrop">
    <div class="modal">
      <h2 class="modal-title">{{ viewEntry.title }}</h2>
      <div class="text-sm text-gray-500 italic mt-2">
        Posted {{ viewEntry.createdAt | relativeTime }}
      </div>
      <p style="margin-bottom: 1.5rem; white-space: pre-wrap; line-height: 1.6;">{{ viewEntry.content }}</p>
      
      <div style="margin-bottom: 1rem;">
        <strong>Tags:</strong>
        <div class="card-tags" style="margin-top: 0.5rem;">
          <span *ngFor="let tag of getTags(viewEntry)" class="tag">
            {{ tag }}
          </span>
        </div>
      </div>
      
      <div style="margin-bottom: 1.5rem;">
        <strong>Mood:</strong>
        <span [ngSwitch]="viewEntry.mood" style="margin-left: 0.5rem; font-size: 1.5rem;">
          <span *ngSwitchCase="'happy'">😊</span>
          <span *ngSwitchCase="'sad'">😔</span>
          <span *ngSwitchCase="'angry'">😡</span>
          <span *ngSwitchCase="'excited'">😃</span>
          <span *ngSwitchDefault>{{ viewEntry.mood || 'No mood set' }}</span>
        </span>
      </div>

      <button (click)="closeViewModal()" class="btn-cancel">
        Close
      </button>
    </div>
  </div>
  <div *ngIf="showModal" class="modal-backdrop">
    <div class="modal scrollable-modal">
      <h3 class="modal-title">{{ editMode ? 'Edit Entry' : 'Create New Entry' }}</h3>
      
      <form (ngSubmit)="submitEntry()" #entryForm="ngForm" class="modal-form">
        <div class="form-group">
          <label class="form-label">Title *</label>
          <input
            [(ngModel)]="newEntry.title"
            name="title"
            type="text"
            class="form-control"
            required
          />
        </div>
        
        <div class="form-group">
          <label class="form-label">Content *</label>
          <textarea
            [(ngModel)]="newEntry.content"
            name="content"
            class="form-control"
            rows="4"
            required
          ></textarea>
        </div>
        
        <button
          type="button"
          (click)="analyzeContent()"
          class="btn-analyze"
        >
        Can’t think of a Title or Mood? Let AI handle it
        </button>
        
        <!-- Tags Section -->
        <div class="form-group">
          <label class="form-label">Tags</label>
          <div *ngFor="let tag of newEntry.tags; let i = index; trackBy: trackByIndex" class="tag-group">
            <input
              [(ngModel)]="newEntry.tags[i]"
              [name]="'tag' + i"
              type="text"
              class="form-control"
              placeholder="Tag"
            />
            <button
              *ngIf="newEntry.tags.length > 1"
              (click)="removeTag(i)"
              type="button"
              class="btn-remove-tag"
            >
              Remove
            </button>
          </div>
          <button
            (click)="addTag()"
            type="button"
            class="btn-add-tag"
          >
            Add Tag
          </button>
        </div>
  
        <div class="form-group">
          <label class="form-label">Mood</label>
          <select 
  [(ngModel)]="newEntry.mood" 
  name="mood" 
  class="form-control"
>
  <option value="" disabled selected>Select a mood</option>
  <option value="happy">Happy 😊</option>
  <option value="sad">Sad 😔</option>
  <option value="angry">Angry 😡</option>
  <option value="excited">Excited 😃</option>
  <option value="neutral">Neutral 😐</option>
  <option value="anxious">Anxious 😰</option>
  <option value="grateful">Grateful 🙏</option>
  <option value="lonely">Lonely 😞</option>
  <option value="motivated">Motivated 💪</option>
  <option value="tired">Tired 😴</option>
  <option value="confused">Confused 😕</option>
</select>

        </div>
  
        <div class="modal-actions">
          <button 
            type="submit" 
            class="btn-submit"
            [disabled]="entryForm.invalid || isLoading"
          >
            {{ isLoading ? 'Processing...' : (editMode ? 'Update Entry' : 'Create Entry') }}
          </button>
          <button 
            (click)="closeModal()" 
            type="button" 
            class="btn-cancel"
          >
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
  
</div>


</div>